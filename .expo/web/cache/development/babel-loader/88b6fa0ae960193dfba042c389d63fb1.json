{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/nicolaseuliarte/Documents/Projects/imprv/components/main/Profile.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\nimport { connect } from \"react-redux\";\n\nfunction Profile(props) {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      userPosts = _useState2[0],\n      setUserPosts = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      following = _useState6[0],\n      setFollowing = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      mycourses = _useState8[0],\n      setmycourses = _useState8[1];\n\n  useEffect(function () {\n    var currentUser = props.currentUser,\n        posts = props.posts;\n\n    if (props.route.params.uid === firebase.auth().currentUser.uid) {\n      setUser(currentUser);\n      setUserPosts(posts);\n    } else {\n      firebase.firestore().collection(\"users\").doc(props.route.params.uid).get().then(function (snapshot) {\n        if (snapshot.exists) {\n          setUser(snapshot.data());\n        } else {\n          console.log(\"does not exist\");\n        }\n      });\n      firebase.firestore().collection(\"posts\").doc(props.route.params.uid).collection(\"userPosts\").orderBy(\"creation\", \"asc\").get().then(function (snapshot) {\n        var posts = snapshot.docs.map(function (doc) {\n          var data = doc.data();\n          var id = doc.id;\n          return _objectSpread({\n            id: id\n          }, data);\n        });\n        setUserPosts(posts);\n      });\n    }\n\n    if (props.following.indexOf(props.route.params.uid) > -1) {\n      setFollowing(true);\n    } else {\n      setFollowing(false);\n    }\n  }, [props.route.params.uid, props.following]);\n  useEffect(function () {\n    if (user === null || user && user.t_s == \"Teacher\") {\n      return;\n    }\n\n    var firestore = firebase.firestore();\n    var snapshot = firestore.collection(\"Courses\");\n    snapshot.onSnapshot(function (querySnapshot) {\n      var livearray = [];\n      var narr = [];\n      var tempDoc = querySnapshot.docs.map(function (doc) {\n        return _objectSpread({\n          id: doc.id\n        }, doc.data());\n      });\n\n      if (user === null || user && user.t_s == \"Teacher\") {\n        return;\n      }\n\n      tempDoc.map(function (data) {\n        if (data.live) {\n          livearray.push(data);\n        }\n      });\n\n      if (props.currentUser.Courses) {\n        props.currentUser.Courses.map(function (item, i) {\n          var index = livearray.findIndex(function (item1) {\n            return item1.id == item.id;\n          });\n\n          if (index != -1) {\n            var iterat = livearray[index];\n            iterat = _objectSpread(_objectSpread({}, iterat), {}, {\n              userprogress: item.lessontaken\n            });\n            console.log(iterat);\n\n            if (Array.isArray(iterat.userprogress) && Array.isArray(iterat.Lessons) && iterat.userprogress.length == iterat.Lessons.length) {\n              console.log(\"hi\");\n            } else {\n              narr.push(iterat);\n            }\n\n            livearray.splice(index, 1);\n          }\n        });\n      }\n\n      setmycourses(narr);\n    });\n  }, [user]);\n\n  var onFollow = function onFollow() {\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).set({});\n  };\n\n  var onUnfollow = function onUnfollow() {\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).delete();\n  };\n\n  var onLogout = function onLogout() {\n    firebase.auth().signOut();\n  };\n\n  if (user === null) {\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.containerInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: \"white\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }, user.name), React.createElement(Text, {\n    style: {\n      color: \"white\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, \"Year Group: \", user.year), user.t_s == \"Student\" && mycourses.length !== 0 && React.createElement(View, {\n    style: {\n      margin: 20,\n      padding: 10,\n      backgroundColor: \"#12151D\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 11\n    }\n  }, React.createElement(FlatList, {\n    numColumns: 1,\n    horizontal: false,\n    data: mycourses,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          props.navigation.navigate(\"CourseDetail\", {\n            item: item,\n            enrolled: true\n          });\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 17\n        }\n      }, React.createElement(View, {\n        style: {\n          marginHorizontal: 20,\n          marginVertical: 5,\n          padding: 5,\n          backgroundColor: \"#12151D\",\n          flexDirection: \"row\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 19\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: \"white\",\n          flex: 1\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }\n      }, item.name), React.createElement(Text, {\n        style: {\n          color: \"white\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 21\n        }\n      }, \"incomplete\")));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  })), props.route.params.uid !== firebase.auth().currentUser.uid ? React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 11\n    }\n  }, following ? React.createElement(Button, {\n    title: \"Following\",\n    onPress: function onPress() {\n      return onUnfollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }) : React.createElement(Button, {\n    title: \"Follow\",\n    onPress: function onPress() {\n      return onFollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  })) : React.createElement(Button, {\n    title: \"Logout\",\n    onPress: function onPress() {\n      return onLogout();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: styles.containerGallery,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }\n  }, React.createElement(FlatList, {\n    numColumns: 3,\n    horizontal: false,\n    data: userPosts,\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      return React.createElement(View, {\n        style: styles.containerImage,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 13\n        }\n      }, React.createElement(Image, {\n        style: styles.image,\n        source: {\n          uri: item.downloadURL\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 15\n        }\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  })));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 50\n  },\n  containerInfo: {\n    marginTop: 10,\n    padding: 10\n  },\n  containerGallery: {},\n  containerImage: {\n    flex: 1 / 3\n  },\n  image: {\n    flex: 1,\n    aspectRatio: 1 / 1\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    currentUser: store.userState.currentUser,\n    posts: store.userState.posts,\n    following: store.userState.following\n  };\n};\n\nexport default connect(mapStateToProps, null)(Profile);","map":{"version":3,"sources":["/Users/nicolaseuliarte/Documents/Projects/imprv/components/main/Profile.js"],"names":["React","useState","useEffect","firebase","connect","Profile","props","userPosts","setUserPosts","user","setUser","following","setFollowing","mycourses","setmycourses","currentUser","posts","route","params","uid","auth","firestore","collection","doc","get","then","snapshot","exists","data","console","log","orderBy","docs","map","id","indexOf","t_s","onSnapshot","querySnapshot","livearray","narr","tempDoc","live","push","Courses","item","i","index","findIndex","item1","iterat","userprogress","lessontaken","Array","isArray","Lessons","length","splice","onFollow","set","onUnfollow","delete","onLogout","signOut","styles","container","containerInfo","color","name","year","margin","padding","backgroundColor","navigation","navigate","enrolled","marginHorizontal","marginVertical","flexDirection","flex","containerGallery","containerImage","image","uri","downloadURL","StyleSheet","create","marginTop","aspectRatio","mapStateToProps","store","userState"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  StyleSheet,\n  Text,\n  View,\n  Image,\n  FlatList,\n  Button,\n  TouchableOpacity,\n} from \"react-native\";\n\n// firebase\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\n\n// redux connection\nimport { connect } from \"react-redux\";\n\nfunction Profile(props) {\n  // hooks\n  const [userPosts, setUserPosts] = useState([]);\n  const [user, setUser] = useState(null);\n  const [following, setFollowing] = useState(false);\n  const [mycourses, setmycourses] = useState([]);\n  // gets the user needed\n  useEffect(() => {\n    const { currentUser, posts } = props;\n    // console.log(currentUser, posts)\n\n    if (props.route.params.uid === firebase.auth().currentUser.uid) {\n      setUser(currentUser);\n      setUserPosts(posts);\n    } else {\n      firebase\n        .firestore()\n        .collection(\"users\")\n        .doc(props.route.params.uid)\n        .get()\n        .then((snapshot) => {\n          if (snapshot.exists) {\n            setUser(snapshot.data());\n          } else {\n            console.log(\"does not exist\");\n          }\n        });\n\n      firebase\n        .firestore()\n        .collection(\"posts\")\n        .doc(props.route.params.uid)\n        .collection(\"userPosts\")\n        .orderBy(\"creation\", \"asc\")\n        .get()\n        .then((snapshot) => {\n          //iterating through the docs to build the array of posts\n          let posts = snapshot.docs.map((doc) => {\n            const data = doc.data();\n            const id = doc.id;\n\n            return { id, ...data };\n          });\n          setUserPosts(posts);\n        });\n    }\n\n    // check index of the string in following if > -1\n    // then it belongs to following and if it = -1 it doesnt exist in the following\n    if (props.following.indexOf(props.route.params.uid) > -1) {\n      setFollowing(true);\n    } else {\n      setFollowing(false);\n    }\n  }, [props.route.params.uid, props.following]);\n  useEffect(() => {\n    if (user === null || (user && user.t_s == \"Teacher\")) {\n      return;\n    }\n    const firestore = firebase.firestore();\n    const snapshot = firestore.collection(\"Courses\");\n    snapshot.onSnapshot((querySnapshot) => {\n      let livearray = [];\n\n      let narr = [];\n      let tempDoc = querySnapshot.docs.map((doc) => {\n        return { id: doc.id, ...doc.data() };\n      });\n      if (user === null || (user && user.t_s == \"Teacher\")) {\n        return;\n      }\n      tempDoc.map((data) => {\n        if (data.live) {\n          livearray.push(data);\n        }\n      });\n\n      if (props.currentUser.Courses) {\n        props.currentUser.Courses.map((item, i) => {\n          let index = livearray.findIndex((item1) => {\n            return item1.id == item.id;\n          });\n\n          if (index != -1) {\n            let iterat = livearray[index];\n            // attaching userprogress along with Course object\n            iterat = { ...iterat, userprogress: item.lessontaken };\n            console.log(iterat);\n            if (\n              Array.isArray(iterat.userprogress) &&\n              Array.isArray(iterat.Lessons) &&\n              iterat.userprogress.length == iterat.Lessons.length\n            ) {\n              console.log(\"hi\");\n            } else {\n              narr.push(iterat);\n            }\n            livearray.splice(index, 1);\n            // setCourses(old => [...old, tempDoc[index]])\n          }\n        });\n      }\n      setmycourses(narr);\n    });\n  }, [user]);\n\n  // follow account\n  const onFollow = () => {\n    firebase\n      .firestore()\n      .collection(\"following\")\n      .doc(firebase.auth().currentUser.uid)\n      .collection(\"userFollowing\")\n      .doc(props.route.params.uid)\n      .set({});\n  };\n\n  // unfollow account\n  const onUnfollow = () => {\n    firebase\n      .firestore()\n      .collection(\"following\")\n      .doc(firebase.auth().currentUser.uid)\n      .collection(\"userFollowing\")\n      .doc(props.route.params.uid)\n      .delete();\n  };\n\n  // logout user\n  const onLogout = () => {\n    firebase.auth().signOut();\n  };\n\n  // if not a user\n  if (user === null) {\n    return <View />;\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.containerInfo}>\n        <Text style={{ color: \"white\" }}>{user.name}</Text>\n        <Text style={{ color: \"white\" }}>Year Group: {user.year}</Text>\n        {user.t_s == \"Student\" && mycourses.length !== 0 && (\n          <View style={{ margin: 20, padding: 10, backgroundColor: \"#12151D\" }}>\n            <FlatList\n              numColumns={1}\n              horizontal={false}\n              data={mycourses}\n              renderItem={({ item }) => (\n                <TouchableOpacity\n                  onPress={() => {\n                    props.navigation.navigate(\"CourseDetail\", {\n                      item,\n                      enrolled: true,\n                    });\n                  }}\n                >\n                  <View\n                    style={{\n                      marginHorizontal: 20,\n                      marginVertical: 5,\n                      padding: 5,\n                      backgroundColor: \"#12151D\",\n                      flexDirection: \"row\",\n                    }}\n                  >\n                    <Text style={{ color: \"white\", flex: 1 }}>{item.name}</Text>\n                    <Text style={{ color: \"white\" }}>incomplete</Text>\n                  </View>\n                </TouchableOpacity>\n              )}\n            />\n          </View>\n        )}\n        {props.route.params.uid !== firebase.auth().currentUser.uid ? (\n          <View>\n            {following ? (\n              <Button title=\"Following\" onPress={() => onUnfollow()} />\n            ) : (\n              <Button title=\"Follow\" onPress={() => onFollow()} />\n            )}\n          </View>\n        ) : (\n          <Button title=\"Logout\" onPress={() => onLogout()} />\n        )}\n      </View>\n\n      <View style={styles.containerGallery}>\n        <FlatList\n          numColumns={3}\n          horizontal={false}\n          data={userPosts}\n          renderItem={({ item }) => (\n            <View style={styles.containerImage}>\n              <Image style={styles.image} source={{ uri: item.downloadURL }} />\n            </View>\n          )}\n        />\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 50,\n  },\n  containerInfo: {\n    marginTop: 10,\n    padding: 10,\n  },\n  containerGallery: {},\n  containerImage: {\n    flex: 1 / 3,\n  },\n  image: {\n    flex: 1,\n    aspectRatio: 1 / 1,\n  },\n});\n\nconst mapStateToProps = (store) => ({\n  currentUser: store.userState.currentUser,\n  posts: store.userState.posts,\n  following: store.userState.following,\n});\n\n// export with connection and map to props\nexport default connect(mapStateToProps, null)(Profile);\n"]},"metadata":{},"sourceType":"module"}