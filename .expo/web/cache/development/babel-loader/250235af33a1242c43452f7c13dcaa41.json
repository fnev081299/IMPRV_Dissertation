{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/nicolaseuliarte/Documents/Projects/imprv/components/main/Createlesson.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React from \"react\";\nimport { useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as DocumentPicker from \"expo-document-picker\";\nimport { Button, TextInput } from \"react-native-paper\";\nimport { connect } from \"react-redux\";\nimport firebase from \"firebase\";\nimport \"firebase/firestore\";\nexport var firestoreAutoId = function firestoreAutoId() {\n  var CHARS = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n  var autoId = \"\";\n\n  for (var i = 0; i < 20; i++) {\n    autoId += CHARS.charAt(Math.floor(Math.random() * CHARS.length));\n  }\n\n  return autoId;\n};\n\nfunction Createlesson(props) {\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      name = _useState2[0],\n      setname = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      Description = _useState4[0],\n      setDescription = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      file = _useState6[0],\n      setfileurl = _useState6[1];\n\n  console.log(props);\n\n  var createLesson = function createLesson() {\n    var autoid = firestoreAutoId();\n    firebase.firestore().collection(\"lessons\").doc(autoid).set({\n      name: name,\n      Description: Description,\n      file: file,\n      id: autoid\n    }).then(function () {\n      firebase.firestore().collection(\"Courses\").doc(props.route.params.id).update({\n        Lessons: firebase.firestore.FieldValue.arrayUnion(autoid)\n      });\n      props.route.params.onback(autoid);\n      props.navigation.goBack();\n      console.log(\"lesson Created Successfully\");\n    }).catch(function (error) {\n      console.error(\"Error adding document: \", error);\n    });\n  };\n\n  console.log(props);\n\n  var loadpdf = function loadpdf() {\n    var options, res, storageRef, num, ref;\n    return _regeneratorRuntime.async(function loadpdf$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            options = {};\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(DocumentPicker.getDocumentAsync({\n              type: \"pdf\",\n              multiple: false\n            }));\n\n          case 4:\n            res = _context.sent;\n            console.log(res);\n            storageRef = firebase.storage().ref();\n            num = Math.floor(Math.random() * 1000);\n            ref = storageRef.child(\"files/\" + (num + res.name));\n            ref.put(res.file).then(function (snapshot) {\n              snapshot.ref.getDownloadURL().then(function (downloadURL) {\n                console.log(\"File available at\", downloadURL);\n                setfileurl(downloadURL);\n              });\n            });\n            _context.next = 15;\n            break;\n\n          case 12:\n            _context.prev = 12;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 12]], Promise);\n  };\n\n  return React.createElement(View, {\n    style: {\n      padding: 15\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, \"Course Name\"), React.createElement(TextInput, {\n    onChangeText: function onChangeText(value) {\n      setname(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, \"Course Description\"), React.createElement(TextInput, {\n    onChangeText: function onChangeText(value) {\n      setDescription(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, file.length == 0 ? React.createElement(Button, {\n    onPress: loadpdf,\n    style: {\n      margin: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }\n  }, \"Upload PDF\") : React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, React.createElement(Button, {\n    onPress: function onPress() {\n      console.log(\"working\");\n    },\n    style: {\n      margin: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, \"View Pdf\"), React.createElement(Button, {\n    onPress: loadpdf,\n    style: {\n      margin: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, \"Change Pdf\")), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, React.createElement(Button, {\n    style: {\n      margin: 10\n    },\n    onPress: function onPress() {\n      createLesson();\n    },\n    mode: \"contained\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, \"Create Lesson\"))));\n}\n\nvar styles = StyleSheet.create({\n  pdfcontainer: {\n    flex: 1,\n    backgroundColor: \"#ecf0f1\"\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    currentUser: store.userState.currentUser\n  };\n};\n\nexport default connect(mapStateToProps)(Createlesson);","map":{"version":3,"sources":["/Users/nicolaseuliarte/Documents/Projects/imprv/components/main/Createlesson.js"],"names":["React","useState","DocumentPicker","Button","TextInput","connect","firebase","firestoreAutoId","CHARS","autoId","i","charAt","Math","floor","random","length","Createlesson","props","name","setname","Description","setDescription","file","setfileurl","console","log","createLesson","autoid","firestore","collection","doc","set","id","then","route","params","update","Lessons","FieldValue","arrayUnion","onback","navigation","goBack","catch","error","loadpdf","options","getDocumentAsync","type","multiple","res","storageRef","storage","ref","num","child","put","snapshot","getDownloadURL","downloadURL","padding","value","margin","styles","StyleSheet","create","pdfcontainer","flex","backgroundColor","mapStateToProps","store","currentUser","userState"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { useState } from \"react\";\r\nimport { View, Text, StyleSheet,  } from \"react-native\";\r\nimport * as DocumentPicker from \"expo-document-picker\";\r\nimport { Button, TextInput } from \"react-native-paper\";\r\nimport { connect } from \"react-redux\";\r\nimport firebase from \"firebase\";\r\nimport \"firebase/firestore\";\r\n\r\nexport const firestoreAutoId = () => {\r\n  const CHARS =\r\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\r\n  let autoId = \"\";\r\n\r\n  for (let i = 0; i < 20; i++) {\r\n    autoId += CHARS.charAt(Math.floor(Math.random() * CHARS.length));\r\n  }\r\n  return autoId;\r\n};\r\nfunction Createlesson(props) {\r\n  const [name, setname] = useState(\"\");\r\n  const [Description, setDescription] = useState(\"\");\r\n  const [file, setfileurl] = useState(\"\");\r\n// creating lesson \r\n  console.log(props);\r\n  const createLesson = () => {\r\n    const autoid = firestoreAutoId();\r\n    firebase\r\n      .firestore()\r\n      .collection(\"lessons\")\r\n      .doc(autoid)\r\n      .set({\r\n        name: name,\r\n        Description: Description,\r\n        file: file,\r\n        id: autoid,\r\n      })\r\n      .then(function () {\r\n        firebase\r\n          .firestore()\r\n          .collection(\"Courses\")\r\n          .doc(props.route.params.id)\r\n          .update({\r\n            Lessons: firebase.firestore.FieldValue.arrayUnion(autoid),\r\n          });\r\n        props.route.params.onback(autoid);\r\n        props.navigation.goBack();\r\n        console.log(\"lesson Created Successfully\");\r\n      })\r\n      .catch(function (error) {\r\n        console.error(\"Error adding document: \", error);\r\n      });\r\n  };\r\n  console.log(props);\r\n\r\n  const loadpdf = async () => {\r\n    try {\r\n      let options = {};\r\n      let res = await DocumentPicker.getDocumentAsync({\r\n        type: \"pdf\",\r\n        multiple: false,\r\n      });\r\n      console.log(res);\r\n      var storageRef = firebase.storage().ref();\r\n      let num = Math.floor(Math.random() * 1000);\r\n      let ref = storageRef.child(`files/${num + res.name}`);\r\n      ref.put(res.file).then((snapshot) => {\r\n        snapshot.ref.getDownloadURL().then((downloadURL) => {\r\n          console.log(\"File available at\", downloadURL);\r\n          setfileurl(downloadURL);\r\n        });\r\n      });\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  return (\r\n    <View style={{ padding: 15 }}>\r\n      <Text>Course Name</Text>\r\n      <TextInput\r\n        onChangeText={(value) => {\r\n          setname(value);\r\n        }}\r\n      />\r\n      <Text>Course Description</Text>\r\n      <TextInput\r\n        onChangeText={(value) => {\r\n          setDescription(value);\r\n        }}\r\n      />\r\n      <View>\r\n        {file.length == 0 ? (\r\n          <Button onPress={loadpdf} style={{ margin: 10 }}>\r\n            Upload PDF\r\n          </Button>\r\n        ) : (\r\n          <View>\r\n            <Button\r\n              onPress={() => {\r\n                console.log(\"working\");\r\n              }}\r\n              style={{ margin: 10 }}\r\n            >\r\n              View Pdf\r\n            </Button>\r\n            <Button onPress={loadpdf} style={{ margin: 10 }}>\r\n              Change Pdf\r\n            </Button>\r\n          </View>\r\n        )}\r\n\r\n        <View>\r\n          <Button\r\n            style={{ margin: 10 }}\r\n            onPress={() => {\r\n              createLesson();\r\n            }}\r\n            mode=\"contained\"\r\n          >\r\n            Create Lesson\r\n          </Button>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  pdfcontainer: {\r\n    flex: 1,\r\n    backgroundColor: \"#ecf0f1\",\r\n  },\r\n});\r\nconst mapStateToProps = (store) => ({\r\n  currentUser: store.userState.currentUser,\r\n});\r\nexport default connect(mapStateToProps)(Createlesson);\r\n"]},"metadata":{},"sourceType":"module"}